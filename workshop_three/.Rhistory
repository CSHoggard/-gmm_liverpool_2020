knitr::opts_chunk$set(tidy.opts=list(width.cutoff=80),tidy=TRUE)
if(!require("Momocs")) install.packages('Momocs', repos='http://cran.us.r-project.org')
if(!require("tidyverse")) install.packages('tidyverse', repos='http://cran.us.r-project.org')
if(!require("rio")) install.packages('rio', repos='http://cran.us.r-project.org')
tpsdata <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_three/tpslines.rds")
database <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_three/database.rds")
database$Archaeological_Unit <- as.factor(database$Archaeological_Unit)
is.factor(database$Archaeological_Unit)
summary(database$Archaeological_Unit)
shape <- Out(tpsdata$coo, fac = database)
shape
panel(shape, main = "", fac = 'Archaeological_Unit')
panel(shape, main = "", fac = 'Archaeological_Unit')
panel(shape, main = "", fac = 'Archaeological_Unit')
mosaic(shape, main = "", fac = 'Archaeological_Unit')
mosaic(shape, ~Archaeological_Unit)
mosaic(shape, ~Archaeological_Unit, asp = 2)
mosaic(shape, ~Archaeological_Unit, asp = 0.5)
mosaic(shape, ~Archaeological_Unit, asp = 1, legend = FALSE)
coo_plot(shape[1], col = "grey", main = "Artefact #1")
mosaic(shape, ~Archaeological_Unit, asp = 1, legend = FALSE)
coo_plot(shape[5], col = "grey", main = "Artefact #1")
coo_plot(shape[7], col = "grey", main = "Artefact #1")
coo_plot(shape[9], col = "grey", main = "Artefact #1")
coo_plot(shape[11], col = "grey", main = "Artefact #1")
coo_plot(shape[1], col = "grey", main = "Artefact #1")
coo_plot(shape[1], col = "grey", centroid = FALSE, main = "Artefact #1")
coo_plot(shape[1], col = "grey", centroid = TRUE, main = "Artefact #1")
coo_plot(shape[1], col = "grey", centroid = TRUE, points = TRUE, main = "Artefact #1")
coo_plot(shape[1], col = "grey", centroid = TRUE, main = "Artefact #1")
shape <- coo_center(shape)
shape <- coo_scale(shape)
shape <- coo_close(shape)
stack(shape, main = "")
test <- coo_slidedirection((shape, "down"))
test <- coo_slidedirection(shape, "down")
stack(test)
shape2 <- coo_slidedirection(shape, "right")
rm(test)
shape2 <- shape %>% coo_slidedirection("right") %>% coo_untilt(ldk = 2)
shape2 <- shape %>% coo_slidedirection("right") %>% coo_untilxt(ldk = 2)
shape2 <- shape %>% coo_slidedirection("right") %>% coo_untiltx(ldk = 2)
shape2 <- shape %>% coo_slidedirection("right") %>% coo_untiltx()
stack(shape2, main = "")
shape2 <- shape %>% coo_slidedirection("right") %>% coo_untiltx() %>% coo_close()
stack(shape2, main = "")
shape2 <- shape %>% coo_slidedirection("down") %>% coo_untiltx()
stack(shape2, main = "")
shape2 <- shape %>% coo_slidedirection("right") %>% coo_untiltx()
stack(shape2, main = "")
stack(shape, main = "Stack: Normalised Outlines")
stack(shape, title = "Stack: Normalised Outlines")
stack(shape2, title = "Stack: Normalised Outlines with coo_slidedirection()")
calibrate_harmonicpower_efourier(shape2, id = 4, nb.h = 20, plot = FALSE)
calibrate_harmonicpower_efourier(shape2, nb.h = 20, plot = FALSE)
calibrate_harmonicpower_efourier(shape2, nb.h = 20, plot = TRUE)
calibrate_harmonicpower_efourier(shape2, nb.h = 25, plot = TRUE)
calibrate_harmonicpower_efourier(shape, nb.h = 25, plot = TRUE)
tpsdata <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_three/tpslines.rds")
database <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_three/database.rds")
database$Archaeological_Unit <- as.factor(database$Archaeological_Unit)
is.factor(database$Archaeological_Unit)
summary(database$Archaeological_Unit)
shape <- Out(tpsdata$coo, fac = database)
shape
panel(shape, main = "", fac = 'Archaeological_Unit')
coo_plot(shape[1], col = "grey", centroid = TRUE, main = "Artefact #1")
shape <- coo_center(shape)
shape <- coo_scale(shape)
shape <- coo_close(shape)
stack(shape, title = "Stack: Normalised Outlines")
calibrate_harmonicpower_efourier(shape, nb.h = 25, plot = TRUE)
calibrate_harmonicpower_efourier(shape, nb.h = 15, plot = TRUE)
shape2 <- shape %>% coo_slidedirection("right") %>% coo_untiltx()
stack(shape2, title = "Stack: Normalised Outlines with coo_slidedirection()")
calibrate_harmonicpower_efourier(shape2, nb.h = 20, plot = FALSE)
calibrate_reconstructions_efourier(shape2, range = 1:20)
calibrate_reconstructions_efourier(shape2, range = 1:20)
calibrate_reconstructions_efourier(shape2, range = 1:20)
calibrate_reconstructions_tfourier(shape2, range = 1:20)
calibrate_reconstructions_sfourier(shape2, range = 1:20)
calibrate_reconstructions_efourier(shape2, range = 1:20)
calibrate_deviations_efourier(shape2, id = 4)
efashape <- efourier(shape2, nb.h = 17, smooth.it = 0, norm = TRUE)
efashape <- efourier(shape2, nb.h = 17, smooth.it = 0, norm = FALSE)
efashape %>% PCA() %>% PCcontrib()
efashape %>% PCA() %>% PCcontrib(range = 1:5)
efashape %>% PCA() %>% PCcontrib(prop = 1:5)
efashape %>% PCA() %>% PCcontrib(nax = 1:5)
efashape <- efourier(shape2, nb.h = 17, smooth.it = 0, norm = TRUE)
efashape %>% PCA() %>% PCcontrib(nax = 1:5)
efashape <- efourier(shape2, nb.h = 17, smooth.it = 0, norm = FALSE)
efashape %>% PCA() %>% PCcontrib(nax = 1:5)
efashape <- efourier(shape2, nb.h = 17, smooth.it = 0, norm = TRUE)
efashape %>% PCA() %>% PCcontrib(nax = 1:5)
efashape[,,1]
pcashape <- PCA(efashape)
scree(pcashape)
scree(pcashape, nax = 20)
scree(pcashape, nax = 1:20)
scree(pcashape)
scree(pcashape)
scree(pcashape)
scree_plot(pcashape)
scree_plot(pcashapem nax = 1:15)
scree_plot(pcashape, nax = 1:15)
PCcontrib(pcashape, nax = 1:7)
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, morphospace_position = "full_axes", zoom = 2, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_PCA(pcashape, axes = c(1,3), ~Archaeological_Unit, morphospace_position = "full_axes", zoom = 2, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_PCA(pcashape, axes = c(1,3), ~Archaeological_Unit, morphospace_position = "xy", zoom = 2, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_PCA(pcashape, axes = c(1,3), ~Archaeological_Unit, morphospace_position = "xy", zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, morphospace_position = "xy", zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, morphospace_position = "circle", zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, morphospace_position = "circle", zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses() %>% pal_alpha()
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, morphospace_position = "circle", zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses() %>% pal_alpha()
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, morphospace_position = "circle", zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses() %>% pal_manual()
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, palette = col_cold, morphospace_position = "circle", zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, palette = pal_seq_Blues, morphospace_position = "circle", zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, palette = pal_seq_Blues, morphospace_position = "circle", zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, palette = pal_seq_Greens, morphospace_position = "circle", zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, palette = pal_div_PiYG, morphospace_position = "circle", zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_PCA(pcashape, axes = c(1,2), ~Archaeological_Unit, palette = pal_div_PiYG, morphospace_position = "circle", zoom = 1.5, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
boxplot(pcashape, ~Archaeological_Unit, nax = 1:5)
boxplot(pcashape, palette = pal_div_PiYG, ~Archaeological_Unit, nax = 1:5)
boxplot(pcashape, ~Archaeological_Unit, nax = 1:5) %>% pal_seq_grey()
boxplot(pcashape, ~Archaeological_Unit, nax = 1:5)
hcontrib(pcashape)
hcontrib(efashape)
dashape <- LDA(pcashape, ~Archaeological_Unit, retain = 0.95)
dashape <- LDA(pcashape, ~Archaeological_Unit, retain = 0.95)
rm(dashape)
dashapefc <- LDA(efashape, ~Archaeological_Unit)
dashape95 <- LDA(pcashape, ~Archaeological_Unit, retain = 0.95)
dashape99 <- LDA(pcashape, ~Archaeological_Unit, retain = 0.99)
dashape99 <- LDA(pcashape, ~Archaeological_Unit, retain = 0.99)
classification_metrics(dashapefc)
dashapefc
dashapefc
dashape95
dashapefc
dashape95
dashape99
dashapefc$CV.correct
dashapefc$CV.ce
dashape99$CV.fac
plot_LDA(dashape, axes = c(1,2), zoom = 2, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_LDA(dashapefc, axes = c(1,2), zoom = 2, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
plot_LDA(dashapefc, axes = c(1,2), zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
dashapefc$CV.ce
plot_LDA(dashapefc, axes = c(1,2), zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses(conf = 0.95)
plot_LDA(dashape99, axes = c(1,2), zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses(conf = 0.95)
plot_LDA(dashapefc, axes = c(1,2), zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_morphospace_LDA() %>% layer_ellipses(conf = 0.95)
plot_LDA(dashapefc, axes = c(1,2), zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_morphospace_LDA(position = "circle") %>% layer_ellipses(conf = 0.95)
plot_LDA(dashapefc, axes = c(1,2), zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_morphospace_LDA(position = "range_axes") %>% layer_ellipses(conf = 0.95)
plot_LDA(dashapefc, axes = c(1,2), zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_morphospace_LDA(position = "range_axes")
plot_LDA(dashapefc, axes = c(1,2), zoom = 1, chull = FALSE) %>% layer_points(cex = 1) %>% layer_morphospace_LDA(position = "circle")
plot_LDA(dashapefc, axes = c(1,2), zoom = 1.5, chull = FALSE) %>% layer_points(cex = 1) %>% layer_morphospace_LDA(position = "circle")
MANOVA(efashape, ~Archaeological_Unit, retain = 0.95)
MANOVA(efashape, fac = Archaeological_Unit, retain = 0.95)
efashape %>% MANOVA(~Archaeological_Unit)
efashape %>% MANOVA(~Archaeological_Unit)
pcashape %>% MANOVA(~Archaeological_Unit, retain = 0.95)
efashape %>% MANOVA(~Archaeological_Unit)
pcashape %>% MANOVA(~Archaeological_Unit, retain = 0.95)
pcashape %>% MANOVA(~Archaeological_Unit, retain = 0.99)
efashape %>% MANOVA_PW(~Archaeological_Unit)
pcashape %>% MANOVA_PW(~Archaeological_Unit, retain = 0.95)
pcashape %>% MANOVA_PW(~Archaeological_Unit, retain = 0.99)
CLUST(efashape, ~Archaeological_Unit, dist_method = "euclidean", hclust_method = "complete")
CLUST(efashape, ~Archaeological_Unit, dist_method = "euclidean", hclust_method = "complete", palette = pal_alpha)
CLUST(efashape, ~Archaeological_Unit, dist_method = "euclidean", hclust_method = "complete", palette = pal_autumn)
CLUST(efashape, ~Archaeological_Unit, dist_method = "euclidean", hclust_method = "complete", palette = pal_qual)
KMEANS(efashape, centers = 4)
KMEANS(pcashape, centers = 4)
KMEDOIDS(pcashape, centers = 4)
efashape %>% NMDS()
x <- efashape %>% NMDS()
vegan::stressplot(x)
rm(x)
meanshapes <- MSHAPES(efashape, ~Archaeological_Unit)
plot_MSHAPES(meanshapes, size = 0.75)
coo_length(shape2)
coo_lw(shape2)
coo_lw(shape2)
coo_length(bot)
coo_lw(shape)
centroidsize <- as_tibble(coo_centsize(shape))
centroidsize <- rename(centroidsize, cs = "value")
pcascores <- as_tibble(pcashape$x)
databasedata <- cbind(database,centroidsize, pcascores)
View(databasedata)
centroidsize <- as_tibble(coo_centsize(shape))
centroidsize <- rename(centroidsize, CS = "value")
pcascores <- as_tibble(pcashape$x)
databasedata <- cbind(database,centroidsize, pcascores)
View(databasedata)
ggplot(databasedata, aes(PC1, CS)) + geom_point(size = 2, pch = 16, alpha = 0.4, colour = "#E69F00", fill = "#ffd475") + geom_smooth(method=lm, se=FALSE) + theme(text = element_text(size=8), axis.text = element_text(size = 8)) + xlab("Principal Component 1") + ylab("CS (Centroid Size)")
```{r chunk32, echo=TRUE, eval=TRUE, message=FALSE, warning=FALSE}
cor(databasedata$PC1, databasedata$CS)
cor.test(databasedata$PC1, databasedata$CS)
cor(databasedata$PC1, databasedata$CS)
cor.test(databasedata$PC1, databasedata$CS)
library(Momocs)
library(rio)
library(tidyverse)
tpsdata <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_three/tpslines.rds")
database <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_three/database.rds")
head(database)
database$Archaeological_Unit <- as.factor(database$Archaeological_Unit)
is.factor(database$Archaeological_Unit)
shape <- Out(tpsdata$coo, fac = database)
shape
coo_length(shape)
shapenorm <- coo_center(shape)
shapenorm <- coo_scale(shapenorm)
shapenorm <- coo_close(shapenorm)
stack(shapenorm, title = "Stack: Normalised Outlines")
shapenorm2 <- shapenorm %>% coo_slidedirection("right") %>% coo_untiltx()
stack(shapenorm2, title = "Stack: Normalised Outlines with coo_slidedirection()")
efashape <- efourier(shapenorm2, nb.h = 17, smooth.it = 0, norm = TRUE)
centroidsize <- as_tibble(coo_centsize(shape))
centroidsize <- rename(centroidsize, CS = "value")
pcascores <- as_tibble(pcashape$x)
pcashape <- PCA(efashape)
centroidsize <- as_tibble(coo_centsize(shape))
centroidsize <- rename(centroidsize, CS = "value")
pcascores <- as_tibble(pcashape$x)
databasedata <- cbind(database,centroidsize, pcascores)
ggplot(databasedata, aes(PC1, CS)) + geom_point(size = 2, pch = 16, alpha = 0.4, colour = "#E69F00", fill = "#ffd475") + geom_smooth(method=lm, se=FALSE) + theme(text = element_text(size=8), axis.text = element_text(size = 8)) + xlab("Principal Component 1") + ylab("CS (Centroid Size)")
cor(databasedata$PC1, databasedata$CS)
cor.test(databasedata$PC1, databasedata$CS)
install.packages("highcharter")
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=80),tidy=TRUE)
library(Momocs)
library(rio)
library(tidyverse)
tpsdata <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_three/tpslines.rds")
database <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_three/database.rds")
head(database)
database$Archaeological_Unit <- as.factor(database$Archaeological_Unit)
is.factor(database$Archaeological_Unit)
panel(shape, main = "", fac = 'Archaeological_Unit')
shape <- Out(tpsdata$coo, fac = database)
shape
panel(shape, main = "", fac = 'Archaeological_Unit')
mosaic(shape, ~Archaeological_Unit, asp = 1, legend = FALSE)
coo_plot(shape[1], col = "grey", centroid = TRUE, main = "Artefact #1")
shapenorm <- coo_center(shape)
shapenorm <- coo_scale(shapenorm)
shapenorm <- coo_close(shapenorm)
stack(shapenorm, title = "Stack: Normalised Outlines")
shapenorm2 <- shapenorm %>% coo_slidedirection("right") %>% coo_untiltx()
stack(shapenorm2, title = "Stack: Normalised Outlines with coo_slidedirection()")
efashape <- efourier(shapenorm2, nb.h = 17, smooth.it = 0, norm = TRUE)
pcashape <- PCA(efashape)
PCcontrib(pcashape, nax = 1:7)
boxplot(pcashape, ~Archaeological_Unit, nax = 1:5)
plot_PCA(pcashape, axes = c(1,3), ~Archaeological_Unit, morphospace_position = "full_axes", zoom = 2, chull = FALSE) %>% layer_points(cex = 1) %>% layer_ellipses()
dashapefc <- LDA(efashape, ~Archaeological_Unit)
dashape95 <- LDA(pcashape, ~Archaeological_Unit, retain = 0.95)
dashape99 <- LDA(pcashape, ~Archaeological_Unit, retain = 0.99)
dashapefc$CV.correct
dashapefc$CV.ce
dashape95$CV.correct
dashape95$CV.ce
dashape99$CV.correct
dashape99$CV.ce
efashape %>% MANOVA(~Archaeological_Unit)
pcashape %>% MANOVA(~Archaeological_Unit, retain = 0.95)
pcashape %>% MANOVA(~Archaeological_Unit, retain = 0.99)
pcashape %>% MANOVA_PW(~Archaeological_Unit, retain = 0.95)
pcashape %>% MANOVA_PW(~Archaeological_Unit, retain = 0.99)
CLUST(pcashape, ~Archaeological_Unit, dist_method = "euclidean", hclust_method = "complete", palette = pal_qual)
CLUST(pcashape, ~Archaeological_Unit, dist_method = "euclidean", hclust_method = "complete", palette = pal_qual, k = 2)
KMEANS(pcashape, centers = 4)
meanshape <- MSHAPES(efashape, ~Archaeological_Unit)
plot_MSHAPES(meanshape, size = 0.75)
centroidsize <- as_tibble(coo_centsize(shape))
centroidsize <- rename(centroidsize, CS = "value")
pcascores <- as_tibble(pcashape$x)
databasedata <- cbind(database,centroidsize, pcascores)
ggplot(databasedata, aes(PC1, CS)) + geom_point(size = 2, pch = 16, alpha = 0.4, colour = "#E69F00", fill = "#ffd475") + geom_smooth(method=lm, se=FALSE) + theme(text = element_text(size=8), axis.text = element_text(size = 8)) + xlab("Principal Component 1") + ylab("CS (Centroid Size)")
