plot_PCA(pca_tutuli, ~classification, chull = FALSE) + layer_morphospace_PCA(position = "range_axes)
plot_PCA(pca_tutuli, ~classification, chull = FALSE) + layer_morphospace_PCA(position = "range_axes")
plot_PCA(pca_tutuli, ~classification) + layer_morphospace_PCA(position = "range_axes")
plot_PCA(pca_tutuli, ~classification, chull = FALSE)
plot_PCA(pca_tutuli, ~classification, chull = FALSE)
plot_PCA(pca_tutuli, ~classification, chull = FALSE, morphospace_position = "range_axes")
plot_PCA(pca_tutuli, ~classification, chull = FALSE, morphospace_position = "range_axes")
plot_PCA(pca_tutuli, ~classification, chull = FALSE, morphospace_position = "range_axes", zoom = 2)
plot_PCA(pca_tutuli, ~classification, chull = FALSE, morphospace_position = "range_axes", zoom = 1.5)
plot_PCA(pca_tutuli, ~classification, chull = FALSE, chullfilled = TRUE, morphospace_position = "range_axes", zoom = 1.5)
plot_PCA(pca_tutuli, ~classification, chull = FALSE, chullfilled = TRUE, morphospace_position = "range_axes", zoom = 1.5)
plot_PCA(pca_tutuli, ~classification, chull = FALSE, chullfilled = TRUE, morphospace_position = "range_axes", zoom = 1.5)
plot_PCA(pca_tutuli, xax = 1, yax = 2, ~classification, chull = FALSE, chullfilled = TRUE, morphospace_position = "range_axes", zoom = 1.5)
plot_PCA(pca_tutuli, axes = c(1,2), ~classification, chull = FALSE, chullfilled = TRUE, morphospace_position = "range_axes", zoom = 1.5)
plot_PCA(pca_tutuli, axes = c(2,4), ~classification, chull = FALSE, chullfilled = TRUE, morphospace_position = "range_axes", zoom = 1.5)
plot_PCA(pca_tutuli, axes = c(1,2), ~date, chull = FALSE, chullfilled = TRUE, morphospace_position = "range_axes", zoom = 1)
boxplot(pca_tutuli, ~date, nax = 1:5)
plot_MSHAPES(pca_tutuli)
plot_MSHAPES(ldk_tutuli)
plot_MSHAPES(gpa_tutuli)
MSHAPES(gpa_tutuli)
MSHAPES(gpa_tutuli, ~classification)
plot_MSHAPES(gpa_tutuli, ~classification)
gpa_tutuli %>% MSHAPES(~classification) %>% plot_MSHAPES()
dashape <- LDA(gpa_tutuli, ~classification)
rm(dashape)
lda_tutuli <- LDA(gpa_tutuli, ~classification)
lda_tutuli$CV.correct
lda_tutuli$CV.ce
lda_tutuli_date <- LDA(gpa_tutuli, ~date)
lda_tutuli_date <- LDA(gpa_tutuli, ~date)
lda_tutuli_date$CV.correct
lda_tutuli_date$CV.ce
manova_tutuli <- MANOVA(gpa_tutuli, ~classification)
manova_tutuli_class <- MANOVA(pca_tutuli, ~classification)
manova_tutuli_date <- MANOVA(pca_tutuli, ~date)
manova_tutuli_class
manova_tutuli_date
PW_MANOVA(manova_tutuli_class)
MANOVA_PW(manova_tutuli_class)
manova_tutuli_class_pw
manova_tutuli_class_pw <- MANOVA_PW(pca_tutuli, ~classification)
manova_tutuli_class <- MANOVA(pca_tutuli, ~classification)
manova_tutuli_class <- MANOVA(pca_tutuli, ~classification)
manova_tutuli_date <- MANOVA(pca_tutuli, ~date)
manova_tutuli_class_pw <- MANOVA_PW(pca_tutuli, ~classification)
manova_tutuli_date_pw <- MANOVA_PW(pca_tutuli, ~date)
skull  <- readmulti.nts(c("SK1.nts","SK2.nts","SK3.nts","SK4.nts","SK5.nts","SK6.nts"))
saveRDS(skull, file =  here::here("skull.rds"))
skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull.rds")
is.array(skull)
skull
skull[1]
skull[,1]
skull[,,1]
skull[,,1]
surface_lm_skull <- read.csv("surfslide_skull.csv", header=TRUE)
surface_lm_skull <- as.matrix(surface_lm_skull)
saveRDS(surface_lm_skull, file =  here::here("surface_lm_skull.rds"))
skull_data <- read.csv("skull_data.csv", header = TRUE, row.names = 1)
saveRDS(skull_data, file =  here::here("skull_data.rds"))
surface_lm_skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/surface_lm_skull.rds")
skull_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull_data.rds")
skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull.rds")
surface_lm_skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/surface_lm_skull.rds")
skull_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull_data.rds")
head(skull_data)
skull_data$Sex <- as.factor(skull_data$Sex)
gpa_skull <- gpagen(skull, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = surface_lm_skull)
plot(gpa_skull)
plot(gpa_skull, color ="lightgray")
plot(skull[,,1])
rgl.open()
plot(skull[,,1])
rgl.points(skull[,,1])
rgl.points(gpa_skull)
rgl.points(gpa_skull$coords)
rgl.points(gpa_skull$coords[1])
rgl.points(gpa_skull$coords[,1])
rgl.points(gpa_skull$coords[,,1])
rgl.points(skull[,,1], r = 0.2)
plotspec(skull)
plotspec(skull[,,1])
plotspec(skull[,,1], r = 0.2)
```{r chunk30, echo=TRUE, eval=FALSE, message=FALSE}
gpa_skull
mean_skull <- mshape(gpa_skull$coords)
mean_skull
plot(mean_skull)
rgl.open()
rgl.points(mean_skull)
rgl.open()
rgl.points(mean_skull)
plotOutliers(gpa_skull)
plotOutliers(skull)
pca_skull <- gm.prcomp(gpa_skull$coords)
pca_skull
summary(pca_skull)
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", legend = TRUE, pch = 19, cex  = 1.5, col = skull_data$Sex)
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex)
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex)
legend("topleft", pch=22, pt.bg = unique(dataset$sex), legend = levels(dataset$sex))
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex)
legend("topleft", pch=22, pt.bg = unique(skull_data$sex), legend = levels(skull_data$sex))
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex)
legend("topleft", pch=22, pt.bg = unique(skull_data$sex), legend = levels(skull_data$sex))
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex, legend = TRUE)
legend("topleft", pch=22, pt.bg = unique(skull_data$sex), legend = levels(skull_data$sex))
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex, legend = TRUE)
legend("topleft", pch=22, pt.bg = unique(skull_data$Sex), legend = levels(skull_data$Sex))
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex, legend = TRUE)
legend("topleft", pch=22, pt.bg = unique(skull_data$Sex), legend = levels(skull_data$Sex))
mean_skull <- as.matrix(mean_skull)
mean_skull <- mshape(gpa_skull$coords)
mean_skull <- mshape(gpa_skull$coords)
plotRefToTarget(pca_skull$shapes.comp1$min, meanshape, method = "TPS")
plotRefToTarget(pca_skull$shapes.comp1$min, mean_skull, method = "TPS")
pca_skull$shapes$shapes.comp1$min
plot(pca_skull$shapes$shapes.comp1$min)
plotRefToTarget(pca_skull$shapes.comp1$min, mean_skull, method = "TPS")
plotRefToTarget(pca_skull$shapes.comp1$min, mean_skull, method = "TPS")
plotRefToTarget(pca_skull$shapes.comp1$min, mean_skull)
mean_skull <- mshape(gpa_skull$coords)
mean_skull_matrix <- as.matrix(mean_skull)
mean_skull <- mshape(gpa_skull$coords)
plotRefToTarget(pca_skull$shapes.comp1$min, mean_skull, method = "TPS")
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$min, method = "TPS")
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$min, method = "TPS")
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$min, method = "TPS")
rm(mean_skull_matrix)
pca_skull$shapes.comp1$min
skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull.rds")
skull[,,1]
rgl.open()
rgl.points(skull[,,1], r = 0.2)
skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull.rds")
rgl.open()
rgl.points(skull[,,1], r = 0.2)
surface_lm_skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/surface_lm_skull.rds")
skull_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull_data.rds")
head(skull_data)
skull_data$Sex <- as.factor(skull_data$Sex)
is.factor(skull_data)
is.factor(skull_data$Sex)
gpa_skull <- gpagen(skull, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = surface_lm_skull)
plot(gpa_skull)
mean_skull <- mshape(gpa_skull$coords)
pca_skull <- gm.prcomp(gpa_skull$coords)
summary(pca_skull)
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex, legend = TRUE)
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex, legend = TRUE)
legend("topleft", pch=22, pt.bg = unique(skull_data$Sex), legend = levels(skull_data$Sex)) would also call the legend
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex, legend = TRUE)
legend("topleft", pch=22, pt.bg = unique(skull_data$Sex), legend = levels(skull_data$Sex))
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$min, method = "TPS")
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$min, method = "TPS")
rgl()
rgl.open()
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$min, method = "TPS")
pca_skull$shapes$shapes.comp1
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$min)
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$min)
plot(gpa_skull)
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$min)
plotRefToTarget(pca_skull$shapes.comp1$min, mean_skull)
plotRefToTarget(pca_skull$shapes.comp1$max, mean_skull)
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$max)
skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull.rds")
surface_lm_skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/surface_lm_skull.rds")
skull_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull_data.rds")
head(skull_data)
skull_data$Sex <- as.factor(skull_data$Sex)
is.factor(skull_data$Sex)
gpa_skull <- gpagen(skull, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = surface_lm_skull)
plot(gpa_skull)
mean_skull <- mshape(gpa_skull$coords)
pca_skull <- gm.prcomp(gpa_skull$coords)
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$max)
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$max, methods = "TPS")
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$max, methods = "TPS")
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$max, methods = "TPS"d)
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$max, methods = "TPS")
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=80),tidy=TRUE)
library(geomorph)
library(geomorph)
library(Momocs)
library(tidyverse)
library(rio)
tutuli_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_lm.rds")
tutuli_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_data.rds")
skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull.rds")
surface_lm_skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/surface_lm_skull.rds")
skull_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull_data.rds")
skull_data$Sex <- as.factor(skull_data$Sex)
gpa_skull <- gpagen(skull, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = surface_lm_skull)
mean_skull <- mshape(gpa_skull$coords)
pca_skull <- gm.prcomp(gpa_skull$coords)
plotRefToTarget(mean_skull, pca_skull$shapes.comp1$max, methods = "TPS")
gpa_skull <- gpagen(skull, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = surface_lm_skull, print.progress = F)
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex, font.lab = 2)
mean_skull <- mshape(gpa_skull$coords)
plotRefToTarget(pca_skull$shapes.comp1$max, mean_skull)
plotRefToTarget(pca_skull$shapes.comp1$max, mean_skull)
mshape(gpa_skull$coords)
mean_skull
mean_skull <- mshape(gpa_skull$coords)
plotRefToTarget(pca_skull$shapes.comp1$max, mean_skull)
plotRefToTarget(pca_skull$shapes.comp1$max, pca_skull$shapes$shapes.comp1$min)
skulldf <- geomorph.data.frame(gpa_skull, sex = skull_data$Sex)
anova(procD.lm(coords ~ sex, data = skulldf))
setwd("C:/Users/cshog/Desktop/patella/gmm_dataset")
landmark_files <- list.files(pattern = ".nts")
landmark_files
patella_lm <- readmulti.nts(landmark_files)
saveRDS(patella_lm, file =  here::here("patella_lm.rds"))
setwd("C:/Users/cshog/Dropbox/CHRISTIAN/Academic Work/Github/-gmm_liverpool_2020/workshop_two")
saveRDS(patella_lm, file =  here::here("patella_lm.rds"))
links <- read.csv(patella_links.csv)
setwd("C:/Users/cshog/Dropbox/CHRISTIAN/Academic Work/Github/-gmm_liverpool_2020/workshop_two")
links <- read.csv(patella_links.csv)
links <- read.csv("patella_links.csv")
patella_links <- read.csv("patella_links.csv")
saveRDS(patella_links, file =  here::here("patella_links.rds"))
setwd("C:/Users/cshog/Dropbox/CHRISTIAN/Academic Work/Github/-gmm_liverpool_2020/workshop_two")
patella_dataset <- read.csv("patella_dataset.csv")
saveRDS(patella_dataset, file =  here::here("patella_dataset.rds"))
setwd("C:/Users/cshog/Dropbox/CHRISTIAN/Academic Work/Github/-gmm_liverpool_2020/workshop_two")
patella_surfslide <- read.csv("patella_surfslide.csv", header = TRUE)
patella_dataset <- read.csv("patella_dataset.csv", row.names = 1)
saveRDS(patella_dataset, file =  here::here("patella_dataset.rds"))
patella_surfslide <- read.csv("patella_surfslide.csv", header = TRUE)
saveRDS(patella_surfslide, file =  here::here("patella_surfslide.rds"))
saveRDS(patella_lm, file =  here::here("patella_lm.rds"))
saveRDS(patella_links, file =  here::here("patella_links.rds"))
saveRDS(patella_dataset, file =  here::here("patella_dataset.rds"))
saveRDS(patella_surfslide, file =  here::here("patella_surfslide.rds"))
patella_dataset <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_dataset.rds")
patella_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_lm.rds")
patella_surfslide <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_surfslide.rds")
patella_links <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_links.rds")
View(patella_surfslide)
library(geomorph)
library(Momocs)
library(tidyverse)
library(rio)
tutuli_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_lm.rds")
tutuli_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_lm.rds")
tutuli_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_data.rds")
tutuli_data$date <- as.factor(tutuli_data$date)
tutuli_data$classification <- as.factor(tutuli_data$classification)
tutuli_data <- column_to_rownames(tutuli_data, var = "artefact_id")
outline<-rbind(c(1,2),c(2,3),c(3,4),c(4,5),c(5,6),c(6,7),c(7,8),c(8,9),c(9,10),c(10,11),c(11,12),c(12,13),c(13,14),c(14,15),c(15,16),c(16,17),c(17,18),c(18,19),c(19,20),c(20,21),c(21,22),c(22,23),c(23,24),c(24,25),c(25,26),c(26,27),c(27,28),c(28,1))
ldk_tutuli <- Ldk(tutuli_lm$coo, links = outline, fac = tutuli_data)
ldk_tutuli[3]
coo_plot(ldk_tutuli[9], cex = 1.5, pch = 20, col = "grey", poly = TRUE, centroid = FALSE, border = TRUE)
gpa_tutuli <- fgProcrustes(ldk_tutuli, tol = 0.1)
pca_tutuli <- PCA(gpa_tutuli)
scree(pca_tutuli)
plot_PCA(pca_tutuli, axes = c(1,2), ~classification, chull = FALSE, chullfilled = TRUE, morphospace_position = "range_axes", zoom = 1)
plot_PCA(pca_tutuli, axes = c(1,2), ~date, chull = FALSE, chullfilled = TRUE, morphospace_position = "range_axes", zoom = 1)
boxplot(pca_tutuli, ~date, nax = 1:5)
gpa_tutuli %>% MSHAPES(~classification) %>% plot_MSHAPES()
lda_tutuli_class <- LDA(gpa_tutuli, ~classification)
lda_tutuli_date <- LDA(gpa_tutuli, ~date)
lda_tutuli_class$CV.correct
lda_tutuli_class$CV.ce
lda_tutuli_date$CV.ce
manova_tutuli_class <- MANOVA(pca_tutuli, ~classification)
manova_tutuli_date <- MANOVA(pca_tutuli, ~date)
manova_tutuli_class_pw <- MANOVA_PW(pca_tutuli, ~classification)
manova_tutuli_class_pw <- MANOVA_PW(pca_tutuli, ~classification)
manova_tutuli_date_pw <- MANOVA_PW(pca_tutuli, ~date)
skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull.rds")
rgl.open()
rgl.points(skull[,,1], r = 0.2)
surface_lm_skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/surface_lm_skull.rds")
skull_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull_data.rds")
skull_data$Sex <- as.factor(skull_data$Sex)
is.factor(skull_data$Sex)
gpa_skull <- gpagen(skull, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = surface_lm_skull, print.progress = F)
plot(gpa_skull)
pca_skull <- gm.prcomp(gpa_skull$coords)
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex, font.lab = 2)
skulldf <- geomorph.data.frame(gpa_skull, sex = skull_data$Sex)
anova(procD.lm(coords ~ sex, data = skulldf))
patella_dataset <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_dataset.rds")
patella_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_lm.rds")
patella_links <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_links.rds")
patella_surfslide <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_surfslide.rds")
patella_dataset <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_dataset.rds")
patella_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_lm.rds")
patella_links <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_links.rds")
patella_surfslide <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_surfslide.rds")
head(patella_dataset)
patella_datset$sex <- as.factor(patella_dataset$sex)
patella_dataset$sex <- as.factor(patella_dataset$sex)
is.factor(patella_dataset$sex)
View(patella_dataset)
is.matrix(patella_surfslide)
patella_surfslide <- as.matrix(patella_surfslide)
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=80),tidy=TRUE)
tutuli_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_lm.rds")
tutuli_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_data.rds")
head(tutuli_data)
library(geomorph)
library(geomorph)
library(Momocs)
library(tidyverse)
library(rio)
tutuli_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_lm.rds")
tutuli_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_data.rds")
tutuli_data$date <- as.factor(tutuli_data$date)
tutuli_data$classification <- as.factor(tutuli_data$classification)
tutuli_data <- column_to_rownames(tutuli_data, var = "artefact_id")
outline<-rbind(c(1,2),c(2,3),c(3,4),c(4,5),c(5,6),c(6,7),c(7,8),c(8,9),c(9,10),c(10,11),c(11,12),c(12,13),c(13,14),c(14,15),c(15,16),c(16,17),c(17,18),c(18,19),c(19,20),c(20,21),c(21,22),c(22,23),c(23,24),c(24,25),c(25,26),c(26,27),c(27,28),c(28,1))
ldk_tutuli <- Ldk(tutuli_lm$coo, links = outline, fac = tutuli_data)
pca_tutuli <- PCA(gpa_tutuli)
gpa_tutuli <- fgProcrustes(ldk_tutuli, tol = 0.1)
pca_tutuli <- PCA(gpa_tutuli)
scree(pca_tutuli)
skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull.rds")
rgl.open()
rgl.points(skull[,,1], r = 0.2)
library(geomorph)
library(Momocs)
library(tidyverse)
library(rio)
tutuli_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_lm.rds")
tutuli_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_data.rds")
head(tutuli_data)
tutuli_data$date <- as.factor(tutuli_data$date)
tutuli_data$classification <- as.factor(tutuli_data$classification)
is.factor(tutuli_data$date)
is.factor(tutuli_data$classification)
View(tutuli_data)
tutuli_data <- column_to_rownames(tutuli_data, var = "artefact_id")
ldk_tutuli <- Ldk(tutuli_lm$coo, links = outline, fac = tutuli_data)
outline<-rbind(c(1,2),c(2,3),c(3,4),c(4,5),c(5,6),c(6,7),c(7,8),c(8,9),c(9,10),c(10,11),c(11,12),c(12,13),c(13,14),c(14,15),c(15,16),c(16,17),c(17,18),c(18,19),c(19,20),c(20,21),c(21,22),c(22,23),c(23,24),c(24,25),c(25,26),c(26,27),c(27,28),c(28,1))
ldk_tutuli <- Ldk(tutuli_lm$coo, links = outline, fac = tutuli_data)
ldk_tutuli[3]
mosaic(ldk_tutuli)
panel(ldk_tutuli)
coo_plot(ldk_tutuli[9], cex = 1.5, pch = 20, col = "grey", poly = TRUE, centroid = FALSE, border = TRUE)
coo_plot(ldk_tutuli[9], cex = 1.5, pch = 20, col = "grey", poly = TRUE, centroid = FALSE, border = TRUE)
coo_plot(ldk_tutuli[220], cex = 1.5, pch = 20, col = "grey", poly = TRUE, centroid = FALSE, border = TRUE)
coo_plot(ldk_tutuli[8], cex = 1.5, pch = 20, col = "grey", poly = TRUE, centroid = FALSE, border = TRUE)
gpa_tutuli <- fgProcrustes(ldk_tutuli, tol = 0.1)
gpa_tutuli
stack(gpa_tutuli, title = "")
pca_tutuli <- PCA(gpa_tutuli)
scree(pca_tutuli)
scree_plot(pca_tutuli, 1:10)
plot_PCA(pca_tutuli, axes = c(1,2), ~classification, chull = FALSE, chullfilled = TRUE, morphospace_position = "range_axes", zoom = 1)
boxplot(pca_tutuli, ~date, nax = 1:5)
gpa_tutuli %>% MSHAPES(~classification) %>% plot_MSHAPES()
lda_tutuli_class <- LDA(gpa_tutuli, ~classification)
lda_tutuli_date <- LDA(gpa_tutuli, ~date)
lda_tutuli_class$CV.correct
lda_tutuli_class$CV.ce
lda_tutuli_date$CV.correct
lda_tutuli_date$CV.ce
lda_tutuli_class$CV.correct
lda_tutuli_class$CV.ce
lda_tutuli_date$CV.correct
lda_tutuli_date$CV.ce
manova_tutuli_class <- MANOVA(pca_tutuli, ~classification)
manova_tutuli_date <- MANOVA(pca_tutuli, ~date)
manova_tutuli_class_pw <- MANOVA_PW(pca_tutuli, ~classification)
manova_tutuli_date_pw <- MANOVA_PW(pca_tutuli, ~date)
manova_tutuli_class
tutuli_lm %>% ldk(links = outline)
tutuli_lm %>% Ldk(links = outline)
tutuli_lm$coo %>% Ldk(links = outline)
tutuli_lm$coo %>% Ldk(links = outline) %>% fgProcrustes()
tutuli_lm$coo %>% Ldk(links = outline) %>% fgProcrustes() %>% PCA() %>% MANOVA_PW()
tutuli_lm$coo %>% Ldk(links = outline) %>% fgProcrustes() %>% PCA() %>% MANOVA_PW(~classification)
tutuli_lm$coo %>% Ldk(links = outline, fac = tutuli_data) %>% fgProcrustes() %>% PCA() %>% MANOVA(~classification)
rm(list = ls())
skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull.rds")
skull[,,1]
plotOutliers(skull)
surface_lm_skull <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/surface_lm_skull.rds")
skull_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/skull_data.rds")
head(skull_data)
skull_data$Sex <- as.factor(skull_data$Sex)
is.factor(skull_data$Sex)
head(skull_data)
gpa_skull <- gpagen(skull, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = surface_lm_skull, print.progress = F)
plot(gpa_skull)
plot(gpa_skull, pch = 21)
plot(gpa_skull, mean = FALSE, label = FALSE, pt.cex = 2)
plot(gpa_skull, mean = FALSE, label = FALSE, plot.param = list(pt.cex = 2))
plot(gpa_skull, mean = FALSE, label = FALSE, plot.param = list(pt.cex = 0.5))
plot(gpa_skull, mean = TRUE, label = FALSE, plot.param = list(pt.cex = 0.5, mean.bg = "red"))
plotOutliers(gpa_skull)
plot(gpa_skull, mean = TRUE, label = FALSE, plot.param = list(pt.cex = 0.5, mean.bg = "red"))
pca_skull <- gm.prcomp(gpa_skull$coords)
summary(pca_skull)
summary(pca_skull)
plot(pca_skull, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = skull_data$Sex, font.lab = 2)
plotRefToTarget(pca_skull$shapes$shapes.comp1$min, pca_skull$shapes$shapes.comp1$max)
plotRefToTarget(pca_skull$shapes$shapes.comp1$min, pca_skull$shapes$shapes.comp1$max)
plotRefToTarget(pca_skull$shapes$shapes.comp1$min, pca_skull$shapes$shapes.comp1$max, method = "surface")
plotRefToTarget(pca_skull$shapes$shapes.comp1$min, pca_skull$shapes$shapes.comp1$max, method = "points")
plot(skull)
plotRefToTarget(pca_skull$shapes$shapes.comp1$min, pca_skull$shapes$shapes.comp1$max, method = "points")
skulldf <- geomorph.data.frame(gpa_skull, sex = skull_data$Sex)
anova(procD.lm(coords ~ sex, data = skulldf))
rm(list = ls())
patella_dataset <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_dataset.rds")
patella_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_lm.rds")
patella_links <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_links.rds")
patella_surfslide <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/patella_surfslide.rds")
head(patella_dataset)
patella_dataset$sex <- as.factor(patella_dataset$sex)
is.factor(patella_dataset$sex)
patella_surfslide <- as.matrix(patella_surfslide)
```{r chunk39, echo=TRUE, eval=TRUE, message=FALSE}
patellagpa <- gpagen(patellalm, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = patella_surfslide)
patellagpa <- gpagen(patella_lm, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = patella_surfslide)
patellagpa <- gpagen(patella_lm, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = patella_surfslide)
patellagpa <- gpagen(patella_lm, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = patella_surfslide)
patellagpa <- gpagen(patella_lm, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = patella_surfslide)
gpa_patella <- gpagen(patella_lm, Proj = TRUE, ProcD = TRUE, curves = NULL, surfaces = patella_surfslide)
plot(patellagpa, links = links, plot.param = list(pt.cex = 0.5, mean.bg = "red")
plot(patellagpa, links = links, plot.param = list(pt.cex = 0.5, mean.bg = "red"))
plot(patellagpa, links = patella_links, plot.param = list(pt.cex = 0.5, mean.bg = "red"))
plot(patellagpa, links = patella_links, plot.param = list(pt.cex = 0.5, mean.cex = 3, mean.bg = "red"))
plot(patellagpa, links = patella_links, plot.param = list(pt.cex = 0.5, mean.cex = 3, mean.bg = "red"))
patella_lm[,,1]
rgl.open()
rgl.points(patella_lm[,,1], r = 0.2, links = patella_links)
3dplot(patella_lm[,,1])
3d.plot(patella_lm[,,1])
plotspec(patella_lm[,,1])
plotspec(patella_lm)
plotspec(patella_lm, patella_surfslide)
plotspec(patella_lm[,,1], patella_surfslide)
plotspec(patella_lm[,,1])
PCA <- gm.prcomp(patellagpa$coords)
summary(PCA)
summary(PCA)
pca_patella <- gm.prcomp(patellagpa$coords)
plot(gpa_patella, links = patella_links, plot.param = list(pt.cex = 0.5, mean.cex = 3, mean.bg = "red"))
plot(gpa_patella, links = patella_links, plot.param = list(pt.cex = 0.5, mean.cex = 5, mean.bg = "red"))
summary(pca_patella)
plot(pca_patella, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", legend = TRUE, pch = 19, cex  = 1.5, col = dataset$sex)
plot(pca_patella, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", legend = TRUE, pch = 19, cex  = 1.5, col = patella_dataset$sex)
plot(pca_patella, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = patella_dataset$sex)
plot(pca_patella, axis1 = 1, axis2 = 2, main = "Principal Component Analysis (PC1 vs. PC2)", pch = 19, cex  = 1.5, col = patella_dataset$sex, font.lab = 2)
pca.scores <- as_tibble(pca_patella$x, rownames = "rownames") %>% column_to_rownames("rownames")
data <- as_tibble(patella_dataset, rownames = "rownames") %>% column_to_rownames("rownames")
pca.sex.scores <- bind_cols(data, pca.scores)
ggplot(pca.sex.scores, aes(Comp1, Comp2, colour = sex)) + geom_point(size = 3) + stat_ellipse(level = 0.66) + coord_fixed() + labs(x = "Principal Component 1", y = "Principal Component 2")
plot(pca_patella, axis1 = 1, axis2 = 2)
plot1 <- plot(pca_patella, axis1 = 1, axis2 = 2)
picknplot.shape(plot1, method = "vector", links = links)
picknplot.shape(plot1, method = "vector", links = patella_links)
picknplot.shape(plot1, method = "vector", links = patella_links)
plotRefToTarget(pca_patella$shapes$shapes.comp1$min, pca_patella$shapes$shapes.comp1$max)
plotRefToTarget(pca_patella$shapes$shapes.comp1$min, pca_patella$shapes$shapes.comp1$max)
df_patella <- geomorph.data.frame(gpa_patella, sex = patella_dataset$sex)
anova(procD.lm(coords ~ sex, data = df_patella))
coords_gpa <- as_tibble(two.d.array(gpa_patella$coords), rownames = "rownames") %>% column_to_rownames("rownames")
gpa.sex.data <- bind_cols(patella_dataset, coords_gpa)
plot(hclust(dist(gpa.sex.data[,2:267])))
plot(hclust(dist(gpa.sex.data[,2:267])), hang = -1, cex = 0.6)
View(coords_gpa)
plot(hclust(dist(coords_gpa)), hang = -1, cex = 0.6)
plot(hclust(dist(gpa_patella$coords)), hang = -1, cex = 0.6)
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=80),tidy=TRUE)
install.packages('geomorph', repos='http://cran.us.r-project.org')
library(geomorph)
library(geomorph)
library(Momocs)
library(tidyverse)
model <- read.ply("patella_example.ply")
digit.fixed(model, 14)
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=80),tidy=TRUE)
library(geomorph)
library(Momocs)
library(tidyverse)
library(rio)
tutuli_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_lm.rds")
tutuli_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_data.rds")
tutuli_lm <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_lm.rds")
tutuli_data <- rio::import("https://github.com/CSHoggard/-gmm_liverpool_2020/raw/master/workshop_two/tutuli_data.rds")
head(tutuli_data)
tutuli_data$date <- as.factor(tutuli_data$date)
tutuli_data$classification <- as.factor(tutuli_data$classification)
is.factor(tutuli_data$date)
is.factor(tutuli_data$classification)
tutuli_data <- column_to_rownames(tutuli_data, var = "artefact_id")
tutuli_data <- column_to_rownames(tutuli_data, var = "artefact_id")
View(tutuli_data)
outline<-rbind(c(1,2),c(2,3),c(3,4),c(4,5),c(5,6),c(6,7),c(7,8),c(8,9),c(9,10),c(10,11),c(11,12),c(12,13),c(13,14),c(14,15),c(15,16),c(16,17),c(17,18),c(18,19),c(19,20),c(20,21),c(21,22),c(22,23),c(23,24),c(24,25),c(25,26),c(26,27),c(27,28),c(28,1))
ldk_tutuli <- Ldk(tutuli_lm$coo, links = outline, fac = tutuli_data)
mosaic(ldk_tutuli)
ldk_tutuli %>% mosaic
mosaic(ldk_tutuli, ~classification)
panel(ldk_tutuli[1:25])
panel(ldk_tutuli[,1:25])
panel(ldk_tutuli, c(3,10))
inspect(ldk_tutuli, 3)
inspect(ldk_tutuli$`1141III-1`)
coo_plot(ldk_tutuli[8], cex = 1.5, pch = 20, col = "grey", poly = TRUE, centroid = FALSE, border = TRUE)
coo_plot(ldk_tutuli[8], cex = 1.5, pch = 20, col = "grey", poly = TRUE, centroid = FALSE, border = TRUE)
coo_plot(ldk_tutuli[8], cex = 1.5, pch = 20, col = "blue", poly = TRUE, centroid = FALSE, border = TRUE)
coo_plot(ldk_tutuli[8], cex = 1.5, pch = 20, col = "green", poly = TRUE, centroid = FALSE, border = TRUE)
coo_plot(ldk_tutuli[8], cex = 1.5, pch = 20, col = "grey", poly = TRUE, centroid = FALSE, border = TRUE)
gpa_tutuli <- fgProcrustes(ldk_tutuli, tol = 0.1)
pca_tutuli <- PCA(gpa_tutuli)
